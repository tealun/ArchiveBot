# ArchiveBot 快速开始 - 5分钟上手指南

本指南帮助你快速了解如何**使用** ArchiveBot。

> 📌 **还没部署？** 请先查看 [部署指南](DEPLOYMENT.md) 完成安装配置，然后回到本指南学习使用。

## 📖 核心功能

ArchiveBot 是你的个人知识管理助手：
- 📦 **一键归档** - 发送任何内容即自动保存
- 🔍 **全文搜索** - 快速找到历史内容
- 🏷️ **智能标签** - 自动分类和手动标签
- 📝 **笔记系统** - 为内容添加想法和批注
- 🤖 **AI增强** - 自动摘要、提取关键点（可选）
- 💬 **AI对话** - 自然语言交互，智能返回文件资源

## 🎯 第一步：获取必要信息

### 1.1 创建 Bot Token

1. 在 Telegram 搜索 [@BotFather](https://t.me/BotFather)
2. 发送 `/newbot`
3. 输入 Bot 名称（如：`我的归档助手`）
4. 输入用户名（必须以bot结尾，如：`my_archive_bot`）
5. **保存** Token（类似：`1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`）

### 1.2 获取你的 User ID

1. 搜索 [@userinfobot](https://t.me/userinfobot)
2. 发送任意消息
3. **保存** 返回的 ID（如：`123456789`）

### 1.3 创建存储频道

1. 创建**私有频道**（名称随意，如：`我的归档存储`）
2. 将你的 Bot 添加为**管理员**
3. 赋予**发送消息**权限
4. 在频道发送任意消息，转发给 [@userinfobot](https://t.me/userinfobot)
5. **保存** 频道 ID（负数，如：`-1001234567890`）

💡 **为什么需要频道？** 用于永久存储图片、视频、文档等大文件。

<details>
<summary>📂 多频道分类存储（可选）</summary>

你可以创建多个频道，按内容类型自动分类存储：

**配置示例**：
```yaml
storage:
  telegram:
    channels:
      default: -1001234567890    # 默认频道（文本、链接）
      images: -1001234567891     # 图片频道
      videos: -1001234567892     # 视频频道
      documents: -1001234567893  # 文档频道
```

**好处**：
- ✅ **分类清晰** - 不同类型内容存储在不同频道
- ✅ **便于管理** - 可以单独查看某类内容
- ✅ **易于备份** - 可以选择性导出特定类型的文件
- ✅ **节省空间** - 频道存储无限制，合理分类不影响检索速度

**注意事项**：
- 所有频道都需要添加 Bot 为管理员
- 如果某类型频道未配置，会使用 `default` 频道
- 内容始终可以通过 Bot 统一搜索，无需关心存储位置

</details>

## 📱 第二步：开始使用

> 💡 **前提**：确保 Bot 已经完成部署并正常运行。如果还没有，请先查看 [部署指南](DEPLOYMENT.md)。

### 初始化

在 Telegram 找到你的 Bot，发送 `/start`

### 归档内容

**直接发送任何内容即可归档！**

```
✅ 文本消息
✅ 链接（自动提取标题和描述）
✅ 图片、视频、文档
✅ 音频、语音
✅ 贴纸、动图
```

### 添加标签

在内容中加 `#标签` 即可分类：

```
这篇文章讲解了 Python 装饰器 #Python #编程
https://github.com/example/repo #开源 #学习
```

### 搜索归档

```bash
/search Python         # 全文搜索 (可用 /s 简写)
/search #Python        # 标签搜索
/search #Python 装饰器  # 组合搜索
```

### 查看统计

```bash
/stats                 # 归档统计 (可用 /st 简写)
/tags                  # 所有标签 (可用 /t 简写)
```

### 管理笔记

```bash
/notes                 # 查看所有笔记
```

在搜索结果中点击 `📝+` 按钮可直接添加笔记。

### 精选收藏

点击搜索结果中的 `🤍` 按钮标记精选，再次点击取消。

## 🤖 启用 AI 功能（可选）

AI 功能可以自动生成摘要、提取关键点、智能标签。

### 支持的 AI 服务

- **Grok (xAI)** - 当前默认，多语言能力强
- **OpenAI GPT-4/3.5** - 效果最好
- **Claude** - 性价比高
- **通义千问** - 国内稳定

### 快速配置

编辑 `config/config.yaml`：

```yaml
ai:
  enabled: true
  auto_summarize: true        # 自动生成摘要
  auto_generate_tags: true    # 自动生成标签
  
  api:
    provider: openai
    api_key: 'your-api-key'   # 你的 API Key
    model: gpt-3.5-turbo
    timeout: 30
```

重启 Bot 即可生效。

### AI 命令

```bash
/ai                    # 查看 AI 状态
/summarize            # 手动生成摘要（回复归档消息）
```

搜索结果中点击 `🤖` 按钮可查看 AI 分析详情。

### AI 对话功能

启用 AI 后，Bot 会智能识别对话意图：

**直接发送自然语言问题**：
- "有多少个视频归档？" - 自动统计回答
- "搜索Python相关的文档" - 自动搜索并展示结果
- "给我看一张风景照片" - 智能查找并**直接发送文件**
- "随机一个编程教程" - 随机返回匹配的资源

**智能资源返回**：
- AI 会根据你的描述智能查询归档
- **绝不虚构URL或文件**，查询不到会如实告知
- 支持按类型/标签/精选状态筛选
- 可直接返回单个文件或展示列表供选择

💡 **提示**：直接用自然语言提问，Bot 会自动理解并执行对应操作

## 🌏 切换语言

```bash
/language              # 选择语言 (可用 /lang 简写)

支持：
- 🇬🇧 English
- 🇨🇳 简体中文
- 🇹🇼 繁體中文
```

## 💡 使用技巧

### 1. 批量归档

批量发送多条消息，Bot 会自动检测并合并处理（支持相册、媒体组等）。

### 2. 转发归档

转发 Telegram 任何频道/群组的消息到 Bot 即可归档。

### 3. 长文本处理

发送长文本时，AI 会自动生成标题和摘要（需启用 AI）。

### 4. 链接预览

发送链接后，Bot 自动提取网页标题、描述、作者等元数据。

### 5. 回收站

删除功能待开发界面，删除的内容会进入回收站，30天内可恢复：

```bash
/trash                 # 查看回收站列表
/trash restore <ID>    # 恢复指定归档
/trash delete <ID>     # 永久删除
/trash empty          # 清空回收站
/trash empty 30       # 删除30天前的内容
```

### 6. 数据导出和备份

```bash
/export                # 导出归档数据（Markdown/JSON/CSV格式）
/backup                # 创建数据库备份
```

## 🔧 常见问题

### Bot 不响应？

1. 确认你的 User ID 与配置中 `owner_id` 一致
2. 检查 Bot 是否正常运行（查看终端输出）
3. 查看日志：`cat data/bot.log`

### 归档失败？

1. 确认 Bot 已添加到频道
2. 确认 Bot 有管理员和发送消息权限
3. 频道 ID 格式正确（负数，如：`-1001234567890`）

### 搜索不到内容？

1. 内容必须先归档才能搜索
2. 使用 `/stats` 查看归档数量
3. 尝试不同的关键词

### 如何重置？

```bash
# 停止 Bot (Ctrl+C)
# 删除数据库
rm data/archive.db

# 重新启动
python main.py
```

## 💬 获得帮助

- 📖 在 Bot 中发送 `/help` 查看完整命令列表
- 🐛 [提交 Issue](https://github.com/tealun/ArchiveBot/issues)
- ⭐ 如果有帮助，请给项目一个星标！

---

**🎉 开始享受你的个人知识归档系统吧！**
